
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. Examining the context of words &#8212; Text and Data Mining Tutorial</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Type-token ratio" href="5%20Type-token_ratio.html" />
    <link rel="prev" title="3. Word frequencies" href="3%20Word%20frequencies.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Text and Data Mining Tutorial</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Welcome.html">
   Welcome
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorial
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1%20Acquiring%20texts.html">
   1. Acquiring texts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2%20Tokenisation.html">
   2. Word frequencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3%20Word%20frequencies.html">
   3. Word frequencies
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. Examining the context of words
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5%20Type-token_ratio.html">
   5. Type-token ratio
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6%20NLP.html">
   6. NLP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7%20Sentiment_analysis.html">
   7. Sentiment analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8%20Lexicons.html">
   8. Lexicons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9%20Diction.html">
   9. Diction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Solutions to the exercises
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/1%20Acquiring%20texts.html">
   1. Acquiring texts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/2%20Tokenisation.html">
   2. Tokenisation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/3%20Word%20frequencies.html">
   3. Word frequencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/4%20Examining_context.html">
   4. Examining context
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/5%20Type-token_ratio.html">
   5. Type-token ratio
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/6%20NLP.html">
   6. NLP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/7%20Sentiment_analysis.html">
   7. Sentiment analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/8%20Lexicons.html">
   8. Lexicons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/9%20Diction.html">
   9. Diction
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/4 Examining_context.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/cdsleiden/tdm-tutorial/gh-pages?urlpath=tree/docs/notebooks/4 Examining_context.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   4. Examining the context of words
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concordances">
     Concordances
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#collocation-analysis">
     Collocation analysis
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooccurrence">
     Cooccurrence
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-4-1">
     Exercise 4.1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-4-2">
     Exercise 4.2.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-4-3">
     Exercise 4.3
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-4-4">
     Exercise 4.4
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-4-5">
     Exercise 4.5
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="examining-the-context-of-words">
<h1>4. Examining the context of words<a class="headerlink" href="#examining-the-context-of-words" title="Permalink to this headline">¶</a></h1>
<div class="section" id="concordances">
<h2>Concordances<a class="headerlink" href="#concordances" title="Permalink to this headline">¶</a></h2>
<p>As was shown in the previous notebook, lists of frequent words can be very useful. They can help to clarify the main concerns or the themes of a text.</p>
<p>To examine <em>how</em> words are used in a text, however, it can also be useful to create a concordance. In a concordance, all the occurrences of a given search term are listed in combination with words that occur before and after this term. Such resources are sometimes referred to as <em>keyword in context</em> lists (KWIC).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">nltk</span></code> package contains a method named <code class="docutils literal notranslate"><span class="pre">concordance()</span></code>. To work with this method, you firstly need to create an instance of the <code class="docutils literal notranslate"><span class="pre">Text</span></code> class. This class is part of the <code class="docutils literal notranslate"><span class="pre">nltk.text</span></code> module. Such a <code class="docutils literal notranslate"><span class="pre">Text</span></code> object can be initialised using a list with all the tokens of a text.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">sent_tokenize</span><span class="p">,</span> <span class="n">word_tokenize</span>
<span class="kn">from</span> <span class="nn">nltk.text</span> <span class="kn">import</span> <span class="n">Text</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;Corpus&#39;</span><span class="p">,</span><span class="s1">&#39;PrideAndPrejudice.txt&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="n">path</span> <span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">full_text</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">tokens</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">full_text</span><span class="p">)</span>
<span class="n">novel</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the code above, the <code class="docutils literal notranslate"><span class="pre">Text</span></code> object is given the name <code class="docutils literal notranslate"><span class="pre">novel</span></code>.</p>
<p>Once you have created such an object, you can use its <code class="docutils literal notranslate"><span class="pre">concordance()</span></code> method. You can supply three parameters:</p>
<ol class="simple">
<li><p>A search term.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">width</span></code> parameter, specifying the extent of the context. With this parameter, you indicate the number of characters before and after the word whose context you want to see.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">lines</span></code> parameter, which specifies the number of results.</p></li>
</ol>
<p>Out of these parameters, only the first one is mandatory. When you leave out the last two parameters, the method will work with its default values: a width of 70 (35 characters before and 35 characters after the search term) and 25 lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">novel</span><span class="o">.</span><span class="n">concordance</span><span class="p">(</span><span class="s1">&#39;marriage&#39;</span> <span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">50</span> <span class="p">,</span> <span class="n">lines</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">concordance()</span></code> method that is defined in <code class="docutils literal notranslate"><span class="pre">nltk</span></code>, the width of the context is defined using a specific number of characters. When you work with such a fixed number of characters, the search term can be shown at the same position on each line, resulting in a keyword-in-context list with a nice and orderly appearance.</p>
<p>The downside of this approach is that the various lines may contain incomplete words. Which you indicate that the size of the context must be set at 20 characters before and after the term, the code simply removes all characters preceding or following the twentieth character.</p>
<p>The cell below contains a definition of a method which can create a somwhat different type of concordance. In this method, named <code class="docutils literal notranslate"><span class="pre">concordance_words()</span></code>, the width of the context is specified using words rather characters. When you supply the number 10 as the value for the parameter defining the width, you will receive all occurrences of the search term, together with 5 words before and 5 words after this search term. The method demands a sting as input. This string can be the full text of a novel.</p>
<p>The results are returned as a list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">tdmh</span> <span class="kn">import</span> <span class="o">*</span>


<span class="k">def</span> <span class="nf">concordance_word</span><span class="p">(</span> <span class="n">text</span><span class="p">,</span> <span class="n">regex</span> <span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">):</span>

    <span class="n">concordance</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span> <span class="n">width</span> <span class="o">/</span><span class="mi">2</span> <span class="p">)</span>

    <span class="n">segment_length</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">words</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span> <span class="n">text</span> <span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">remove_punctuation</span><span class="p">(</span> <span class="n">words</span> <span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="n">regex</span> <span class="p">,</span> <span class="n">w</span> <span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="p">):</span>
            <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">i</span> <span class="o">-</span> <span class="n">distance</span> <span class="p">,</span> <span class="p">(</span> <span class="n">i</span> <span class="o">+</span> <span class="n">distance</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">):</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">match</span> <span class="o">+=</span> <span class="n">words</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
            <span class="n">concordance</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">match</span> <span class="p">)</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">concordance</span>
</pre></div>
</div>
</div>
</div>
<p>The cell below contains an illustration of how you can use this method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;Pride_and_Prejudice.txt&#39;</span> <span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">full_text</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    
<span class="n">fragments</span> <span class="o">=</span> <span class="n">concordance_word</span><span class="p">(</span> <span class="n">full_text</span> <span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;marriage&#39;</span> <span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;There are </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">fragments</span><span class="p">)</span><span class="si">}</span><span class="s1"> ocurrences of the word &quot;marriage&quot;.&#39;</span><span class="p">)</span>

<span class="n">number_of_results</span> <span class="o">=</span> <span class="mi">5</span>

<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;Here are the first </span><span class="si">{</span><span class="n">number_of_results</span><span class="si">}</span><span class="s1"> occurrences:</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">[:</span><span class="n">number_of_results</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As you can see in the definition of <code class="docutils literal notranslate"><span class="pre">concordance_word()</span></code>, you can see that the method searches for occurrences of the supplied search term as a regular expression. The second parameter of this method can also be a more complicated regular expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fragments</span> <span class="o">=</span> <span class="n">concordance_word</span><span class="p">(</span><span class="n">full_text</span> <span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;(\bhates?\b)|(\bloves?\b)&#39;</span> <span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">[</span><span class="mi">15</span><span class="p">:</span><span class="mi">22</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="collocation-analysis">
<h2>Collocation analysis<a class="headerlink" href="#collocation-analysis" title="Permalink to this headline">¶</a></h2>
<p>Collocation analyses focus on the words that are used in the vicinity of a provided search term. It may be viewed as an extension of the principle underlying the creation of concordances. To perform a collocation analysis, we can look at the environments of a search term through a ‘window’ consisting of a given number of words. The words that are used in this context can obviously be counted. The aim of a collocation analysis is to identify the words that are used most frequently in the neighbourhood of a given word.</p>
<p>Such collocation analyses can be carried out using the <code class="docutils literal notranslate"><span class="pre">collocation()</span></code> method that is defined below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">collocation</span><span class="p">(</span> <span class="n">text</span> <span class="p">,</span> <span class="n">regex</span> <span class="p">,</span> <span class="n">width</span> <span class="p">):</span>

    <span class="n">freq_c</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">sentences</span> <span class="o">=</span> <span class="n">sent_tokenize</span><span class="p">(</span> <span class="n">text</span> <span class="p">)</span>

    <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">:</span>

        <span class="n">words</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span> <span class="n">sentence</span> <span class="p">)</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">remove_punctuation</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="n">regex</span> <span class="p">,</span> <span class="n">w</span> <span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="p">):</span>
                <span class="n">index_regex</span> <span class="o">=</span> <span class="n">i</span> 

                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">i</span> <span class="o">-</span> <span class="n">distance</span> <span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">distance</span> <span class="p">):</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="n">words</span><span class="p">[</span><span class="n">index_regex</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">word</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                            <span class="n">freq_c</span><span class="p">[</span> <span class="n">word</span> <span class="p">]</span> <span class="o">=</span> <span class="n">freq_c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="n">word</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            
    <span class="k">return</span> <span class="n">freq_c</span>
</pre></div>
</div>
</div>
</div>
<p>The parameters are the same as those of the <code class="docutils literal notranslate"><span class="pre">concordance_word()</span></code> method:</p>
<ol class="simple">
<li><p>The text that needs to be analysed.</p></li>
<li><p>A search term, which will be treated as a regular expression.</p></li>
<li><p>A number representing the width of the context (or, ot be more precise: the number of words).</p></li>
</ol>
<p>This function returns a dictionary listing all the words found near the search term that is provided, together with the frequencies of these words.</p>
<p>The code below makes use of the function <code class="docutils literal notranslate"><span class="pre">sortedByValue()</span></code> which can sort a dictionary by value, and the list of stopwords from <code class="docutils literal notranslate"><span class="pre">nltk</span></code> to remove the function words.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nearby_words</span> <span class="o">=</span> <span class="n">collocation</span><span class="p">(</span> <span class="n">full_text</span> <span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;marriage&#39;</span> <span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="n">stopwords</span> <span class="o">=</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>

<span class="n">nearby_words_sorted</span> <span class="o">=</span> <span class="n">sortedByValue</span><span class="p">(</span> <span class="n">nearby_words</span> <span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span> <span class="n">nearby_words_sorted</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">):</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">nearby_words_sorted</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span> <span class="ow">and</span> <span class="n">freq</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">word</span><span class="si">}</span><span class="s1"> =&gt; </span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cooccurrence">
<h2>Cooccurrence<a class="headerlink" href="#cooccurrence" title="Permalink to this headline">¶</a></h2>
<p>Once you have established that two specific words are often used in combination, you can begin to study specific combinations of words in more detail using the <code class="docutils literal notranslate"><span class="pre">cooccurrence()</span></code> method that is defined below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cooccurrence</span><span class="p">(</span> <span class="n">text</span> <span class="p">,</span> <span class="n">word1</span> <span class="p">,</span> <span class="n">word2</span> <span class="p">,</span> <span class="n">width</span> <span class="p">):</span>
    
    <span class="n">relevant_sentences</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span> <span class="s1">&#39;\s+&#39;</span> <span class="p">,</span> <span class="s1">&#39; &#39;</span> <span class="p">,</span> <span class="n">text</span> <span class="p">)</span>
    <span class="n">sentences</span> <span class="o">=</span> <span class="n">sent_tokenize</span><span class="p">(</span> <span class="n">text</span> <span class="p">)</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="o">+</span> <span class="n">word1</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="p">,</span> <span class="n">s</span> <span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="p">)</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="o">+</span> <span class="n">word2</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="p">,</span> <span class="n">s</span> <span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="p">):</span>

            <span class="n">words</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">word1_indexes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">word2_indexes</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="o">+</span> <span class="n">word1</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="p">,</span> <span class="n">w</span> <span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="p">):</span>
                    <span class="n">word1_indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="o">+</span> <span class="n">word2</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\b&#39;</span> <span class="p">,</span> <span class="n">w</span> <span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="p">):</span>
                    <span class="n">word2_indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">word1_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">word2_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">difference</span> <span class="o">=</span> <span class="n">word1_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">word2_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">difference</span> <span class="o">=</span> <span class="n">word2_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">word1_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">difference</span> <span class="o">&lt;=</span> <span class="n">width</span><span class="p">:</span>
                <span class="n">relevant_sentences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">relevant_sentences</span>
                       
</pre></div>
</div>
</div>
</div>
<p>The useage of the method is as follows:</p>
<ul class="simple">
<li><p>As the first parameter, you mus provide the full text that you want to analyse, as a single string.</p></li>
<li><p>As the second and the third parameter, you need to mention the two words that you are interested in.</p></li>
<li><p>How close should these two words be? The fourth parameter specifies the number of words that are allowed in between the two words you focus on.</p></li>
</ul>
<p>The method <code class="docutils literal notranslate"><span class="pre">cooccurrence()</span></code> returns all the sentences containing the two words that you focus on. The distance (measured in number of words) will not be greater than the width that you specified.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="n">cooccurrence</span><span class="p">(</span> <span class="n">full_text</span> <span class="p">,</span> <span class="s1">&#39;marriage&#39;</span> <span class="p">,</span> <span class="s1">&#39;lydia&#39;</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="exercises">
<h1>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h1>
<div class="section" id="exercise-4-1">
<h2>Exercise 4.1<a class="headerlink" href="#exercise-4-1" title="Permalink to this headline">¶</a></h2>
<p>Create a concordance for the word ‘river’ in the novel <em>Heart of Darkness</em>. You can find the full text in the ‘Corpus’ folder. Work with a width of 50 characters (i.e. 25 characters before and 25 characters after this search term).</p>
<p>Note that all the new functions that have been explained in this notebook have also been defined in the package <code class="docutils literal notranslate"><span class="pre">tdmh</span></code>. Top use these methods, you need to import them first.</p>
<p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">tdmh</span> <span class="pre">import</span> <span class="pre">*</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tdmh</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-4-2">
<h2>Exercise 4.2.<a class="headerlink" href="#exercise-4-2" title="Permalink to this headline">¶</a></h2>
<p>Create a concordance for the word ‘darkness’ in the novel Heart of Darkness. This time, work with a width of 20 words (i.e. 10 words before and 10 words after this search term). Display the first 15 occurrences.</p>
</div>
<div class="section" id="exercise-4-3">
<h2>Exercise 4.3<a class="headerlink" href="#exercise-4-3" title="Permalink to this headline">¶</a></h2>
<p>Create a concordance for all occurrences of the following words in the novel <em>Heart of Darkness</em>:</p>
<ul class="simple">
<li><p>murky</p></li>
<li><p>shadowy</p></li>
<li><p>gloomy</p></li>
<li><p>brooding</p></li>
</ul>
<p>To do this, provide a regular expression containing these words as the second parameter for the <code class="docutils literal notranslate"><span class="pre">concordance_word()</span></code> function. Work with a width of 20 words (i.e. 10 words before and 10 words after this search term). Display the first 15 occurrences.</p>
</div>
<div class="section" id="exercise-4-4">
<h2>Exercise 4.4<a class="headerlink" href="#exercise-4-4" title="Permalink to this headline">¶</a></h2>
<p>In <em>Heart of Darkness</em>, which words are used most frequently in the vicinity of the word ‘Kurtz’? Consider 8 words before and 8 words after all the occurrences of this specific word.</p>
</div>
<div class="section" id="exercise-4-5">
<h2>Exercise 4.5<a class="headerlink" href="#exercise-4-5" title="Permalink to this headline">¶</a></h2>
<p>Find all the sentences in <em>Heart of Darkness</em> contain the words ‘heart’ and ‘darkness’. Make sure that, in these sentences, there are no more than 5 words in between these two words.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "cdsleiden/tdm-tutorial",
            ref: "gh-pages",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="3%20Word%20frequencies.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">3. Word frequencies</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="5%20Type-token_ratio.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">5. Type-token ratio</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Peter Verhaar<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>