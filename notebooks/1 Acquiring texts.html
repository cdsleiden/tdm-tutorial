
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. Acquiring texts &#8212; Text and Data Mining Tutorial</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. Word frequencies" href="2%20Tokenisation.html" />
    <link rel="prev" title="Welcome" href="../Welcome.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Text and Data Mining Tutorial</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Welcome.html">
   Welcome
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorial
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Acquiring texts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2%20Tokenisation.html">
   2. Word frequencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3%20Word%20frequencies.html">
   3. Word frequencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4%20Examining_context.html">
   4. Examining the context of words
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5%20Type-token_ratio.html">
   5. Type-token ratio
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6%20NLP.html">
   6. NLP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7%20Sentiment_analysis.html">
   7. Sentiment analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8%20Lexicons.html">
   8. Lexicons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9%20Diction.html">
   9. Diction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Solutions to the exercises
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/1%20Acquiring%20texts.html">
   1. Acquiring texts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/2%20Tokenisation.html">
   2. Tokenisation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/3%20Word%20frequencies.html">
   3. Word frequencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/4%20Examining_context.html">
   4. Examining context
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/5%20Type-token_ratio.html">
   5. Type-token ratio
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/6%20NLP.html">
   6. NLP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/7%20Sentiment_analysis.html">
   7. Sentiment analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/8%20Lexicons.html">
   8. Lexicons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Solutions/9%20Diction.html">
   9. Diction
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/1 Acquiring texts.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/cdsleiden/tdm-tutorial/gh-pages?urlpath=tree/docs/notebooks/1 Acquiring texts.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   1. Acquiring texts
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acquiring-the-texts-for-your-corpus">
     Acquiring the texts for your corpus
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#downloading-a-text-from-project-gutenberg">
     Downloading a text from Project Gutenberg
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extract-text-from-pdf-files">
     Extract text from PDF files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1-1">
     Exercise 1.1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1-2">
     Exercise 1.2.
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="acquiring-texts">
<h1>1. Acquiring texts<a class="headerlink" href="#acquiring-texts" title="Permalink to this headline">¶</a></h1>
<div class="section" id="acquiring-the-texts-for-your-corpus">
<h2>Acquiring the texts for your corpus<a class="headerlink" href="#acquiring-the-texts-for-your-corpus" title="Permalink to this headline">¶</a></h2>
<p>Projects in field of Text and Data Mining (TDM) typically start with the preparation of a corpus. Machine-readable texts can be downloaded from a wide range of sources:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.gutenberg.org/">Project Gutenberg</a></p></li>
<li><p><a class="reference external" href="https://github.com/distantreading/distantreading.github.io">Distant Reading E-COST</a></p></li>
<li><p><a class="reference external" href="https://dbnl.nl/">DBNL</a></p></li>
<li><p><a class="reference external" href="https://github.com/textcreationpartnership/Texts">Text Creation Partnership</a></p></li>
<li><p><a class="reference external" href="https://www.wikidata.org/">WikiData</a></p></li>
<li><p><a class="reference external" href="https://shakespeare.folger.edu/download/">Folger Shakespeare Digital Library</a></p></li>
<li><p><a class="reference external" href="https://ota.bodleian.ox.ac.uk/repository/xmlui/">Oxford Text Archive</a></p></li>
<li><p><a class="reference external" href="https://www.opensubtitles.com/en">Open Subtitles</a></p></li>
<li><p><a class="reference external" href="https://textgridrep.org/">TextGrid Repository</a></p></li>
<li><p><a class="reference external" href="https://archive.org/details/opensource">Internet Archive</a></p></li>
<li><p><a class="reference external" href="https://openlibrary.org/">Open Library</a></p></li>
<li><p><a class="reference external" href="https://www.delpher.nl/">Delpher</a></p></li>
<li><p><a class="reference external" href="https://www.nrc.nl/index/archief/">Archive of NRC (Dutch Newspaper)</a></p></li>
<li><p><a class="reference external" href="https://www.dbnl.org/">Digital Library of the Netherlands</a></p></li>
</ul>
</div>
<div class="section" id="downloading-a-text-from-project-gutenberg">
<h2>Downloading a text from Project Gutenberg<a class="headerlink" href="#downloading-a-text-from-project-gutenberg" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://gutenberg.org">Project Gutenberg</a>, for example, is an online repository containing tens of thousands of machine readable texts in a variety of formats.</p>
<p>For TDM projects, the  plain TXT format , with characters encoded accordingh to UTF-8 encoding, is usually the most convenient format.  If you know the URL of a specific TXT file on <em>Project Gutenberg</em>, you can download this text using the <code class="docutils literal notranslate"><span class="pre">requests</span></code> library.</p>
<p>The code below downloads the file with the url <a class="reference external" href="https://www.gutenberg.org/files/4300/4300-0.txt">https://www.gutenberg.org/files/4300/4300-0.txt</a>. This file contains the full text of James Joyces’s novel <em>Ulysses</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">text_url</span> <span class="o">=</span> <span class="s1">&#39;https://www.gutenberg.org/files/4300/4300-0.txt&#39;</span>


<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="n">text_url</span> <span class="p">)</span>

<span class="k">if</span> <span class="n">response</span><span class="p">:</span>
    <span class="n">response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
    <span class="n">full_text</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</pre></div>
</div>
</div>
</div>
<p>If you have managed to run this code successfully, the string named <code class="docutils literal notranslate"><span class="pre">full_text</span></code> should contain the full contents of the file that was downloaded. We can easily calculate the total number of characters in the text file by making use of <code class="docutils literal notranslate"><span class="pre">len()</span></code>. |</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">full_text</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>When you download text files from Project Gutenberg, it is important to bear in mind that the files all contain a ‘boilerplate’, before and after the actual full text. These headers and footers contain some legal texts, and often some information about the digitisation process.</p>
<p>The Gutenberg header and footer obviously needs to be removed from the file before you start to analyse the text.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">remove_pg_boilerplate()</span></code>, defined below, removes the boilerplate, based on the string that are used at the end of the header (‘START OF THE PROJECT GUTENBURG EBOOK’) and at the beginning of the footer (‘END OF THE PROJECT GUTENBURG EBOOK’). The function selects all the text in between these two strings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span> 

<span class="k">def</span> <span class="nf">remove_pg_boilerplate</span><span class="p">(</span><span class="n">complete_file</span><span class="p">):</span>
    
    <span class="n">lines</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="sa">r</span><span class="s1">&#39;\n&#39;</span> <span class="p">,</span> <span class="n">complete_file</span> <span class="p">)</span>
    <span class="n">read_mode</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="n">full_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="c1">#print(line)</span>
        <span class="k">if</span> <span class="n">read_mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">full_text</span> <span class="o">+=</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="sa">r</span><span class="s1">&#39;\*{3,}\s+START\s+OF\s+TH(E|IS)\s+PROJECT\s+GUTENBERG\s+EBOOK&#39;</span> <span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="p">):</span>
            <span class="n">read_mode</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="sa">r</span><span class="s1">&#39;\*{3,}\s+END\s+OF\s+TH(E|IS)\s+PROJECT\s+GUTENBERG\s+EBOOK&#39;</span> <span class="p">,</span>  <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="p">):</span>
            <span class="n">read_mode</span> <span class="o">=</span> <span class="mi">0</span>
            
    <span class="n">full_text</span> <span class="o">=</span> <span class="n">full_text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span> <span class="sa">r</span><span class="s1">&#39;^Produced by&#39;</span> <span class="p">,</span> <span class="n">full_text</span> <span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="p">):</span>
        <span class="n">full_text</span> <span class="o">=</span> <span class="n">full_text</span><span class="p">[</span> <span class="n">full_text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_text</span><span class="p">)</span> <span class="p">]</span>
    <span class="k">return</span> <span class="n">full_text</span>
</pre></div>
</div>
</div>
</div>
<p>In the code below, the result of the <code class="docutils literal notranslate"><span class="pre">remove_pg_boilerplate()</span></code> function is asigned to a varibable named <code class="docutils literal notranslate"><span class="pre">cleaned_text</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cleaned_text</span> <span class="o">=</span> <span class="n">remove_pg_boilerplate</span><span class="p">(</span><span class="n">full_text</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>The text can be saved on your computer using the <code class="docutils literal notranslate"><span class="pre">open()</span></code> function in the write (‘<code class="docutils literal notranslate"><span class="pre">w</span></code>’) mode.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="s1">&#39;ulysses.txt&#39;</span> <span class="p">,</span> <span class="s1">&#39;w&#39;</span> <span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">cleaned_text</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The code below defines a dictionary containing both the URLs and the titles of a number of books available at Project Gutenberg. The files that are listed in this dictionary can all be downloaded using the steps that have been discussed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">gutenberg_files</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;http://www.gutenberg.org/files/158/158-0.txt&#39;</span><span class="p">:</span><span class="s1">&#39;Emma&#39;</span><span class="p">,</span>
    <span class="s1">&#39;http://www.gutenberg.org/files/161/161-0.txt&#39;</span><span class="p">:</span><span class="s1">&#39;Sense and Sensibility&#39;</span><span class="p">,</span>
    <span class="s1">&#39;http://www.gutenberg.org/files/1342/1342-0.txt&#39;</span><span class="p">:</span><span class="s1">&#39;Pride and Prejudice&#39;</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">gutenberg_files</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading &quot;</span> <span class="o">+</span> <span class="n">gutenberg_files</span><span class="p">[</span><span class="n">url</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; ...&quot;</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span> <span class="sa">r</span><span class="s1">&#39;\s+&#39;</span> <span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="p">,</span>  <span class="n">gutenberg_files</span><span class="p">[</span><span class="n">url</span><span class="p">]</span> <span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
        <span class="n">response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
        <span class="n">full_text</span> <span class="o">=</span> <span class="n">remove_pg_boilerplate</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>           
        <span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span> <span class="n">title</span> <span class="p">,</span> <span class="s1">&#39;w&#39;</span> <span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">full_text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Done!&#39;</span><span class="p">)</span>    
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extract-text-from-pdf-files">
<h2>Extract text from PDF files<a class="headerlink" href="#extract-text-from-pdf-files" title="Permalink to this headline">¶</a></h2>
<p>The notebooks written for this tutorial assume that texts are stored as TXT files with the characters encoded as UTF-8. If you have downloaded texts in other formats, you need to convert these text into TXT first.</p>
<p>There are a number of packages that you can use to convert PDF files, into TXT. One of these is <code class="docutils literal notranslate"><span class="pre">PyPDF2</span></code>.</p>
<p>This library is not part of the Anaconda distribution of Python, so it needs to be installed before you can use it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="o">!</span>pip install PyPDF2
</pre></div>
</div>
</div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">PyPDF2</span></code>, you can create a <code class="docutils literal notranslate"><span class="pre">pdfReader</span></code> object, containing a method named <code class="docutils literal notranslate"><span class="pre">extractText()</span></code> which can convert pages in PDF files into plain text files.</p>
<p>Succes cannot be guaranteed, however. If a page in the PDF contains multiple columns, some of the lines may get mixed up. If the file uses a character encoding system other than UTF-8, there can also be some isues with the text of the file. The text that is created by the script will probably need to be edited manually, unfortunately.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyPDF2</span>  
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">pdf_url</span> <span class="o">=</span> <span class="s1">&#39;https://scholarlypublications.universiteitleiden.nl/access/item%3A2729408/view&#39;</span>

<span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;downloaded.pdf&#39;</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdf_url</span><span class="p">)</span>
<span class="k">if</span> <span class="n">response</span><span class="p">:</span>
    <span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span> <span class="n">file</span> <span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;Reading </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1"> ...&#39;</span><span class="p">)</span>
    
<span class="n">pdf_obj</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span> <span class="n">file</span> <span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>

<span class="n">filename</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span>  <span class="p">:</span> <span class="n">file</span><span class="o">.</span><span class="n">rindex</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.txt&#39;</span>  

<span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span> <span class="n">filename</span> <span class="p">,</span> <span class="s1">&#39;w&#39;</span> <span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span> <span class="p">)</span>
<span class="n">pdfReader</span> <span class="o">=</span> <span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfFileReader</span><span class="p">(</span><span class="n">pdf_obj</span><span class="p">)</span>  

<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;The PDF file has </span><span class="si">{</span><span class="n">pdfReader</span><span class="o">.</span><span class="n">numPages</span><span class="si">}</span><span class="s1"> pages.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">)</span>  

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pdfReader</span><span class="o">.</span><span class="n">numPages</span><span class="p">):</span>
    <span class="n">page_obj</span> <span class="o">=</span> <span class="n">pdfReader</span><span class="o">.</span><span class="n">getPage</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  

    <span class="n">txt</span> <span class="o">=</span> <span class="n">page_obj</span><span class="o">.</span><span class="n">extractText</span><span class="p">()</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">,</span> <span class="n">txt</span><span class="p">)</span>

    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>  


<span class="n">pdf_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">out</span><span class="o">.</span><span class="n">close</span>
</pre></div>
</div>
</div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">remove_pg_boilerplate()</span></code>, discussed in this notebook, is also included in the <code class="docutils literal notranslate"><span class="pre">tdmh</span></code> package. You can use this function in other notebooks after you have installed the package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install tdmh
</pre></div>
</div>
</div>
</div>
<p>Once you managed to install the package, you can download all of its methods, as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tdmh</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="exercises">
<h1>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h1>
<div class="section" id="exercise-1-1">
<h2>Exercise 1.1<a class="headerlink" href="#exercise-1-1" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Download all the text files that are listed in the following dictionary.</p></li>
</ol>
<p><code class="docutils literal notranslate">&#160;&#160;&#160; <span class="pre">gutenberg_files</span> <span class="pre">=</span> <span class="pre">{</span>&#160;&#160;&#160;&#160; <span class="pre">'https://www.gutenberg.org/files/98/98-0.txt'</span> <span class="pre">:</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">'A</span> <span class="pre">Tale</span> <span class="pre">of</span> <span class="pre">Two</span> <span class="pre">Cities',</span>&#160;&#160;&#160;&#160; <span class="pre">'https://www.gutenberg.org/files/580/580-0.txt':</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">'The</span> <span class="pre">Pickwick</span> <span class="pre">Papers'</span>&#160;&#160;&#160; <span class="pre">}</span></code></p>
<p>Save these files in a folder named ‘Texts’. In Python, you can make new folders using the <code class="docutils literal notranslate"><span class="pre">os</span></code> package, as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">os.mkdir('Texts')</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">gutenberg_files</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;https://www.gutenberg.org/files/98/98-0.txt&#39;</span> <span class="p">:</span>
        <span class="s1">&#39;A Tale of Two Cities&#39;</span><span class="p">,</span>
    <span class="s1">&#39;https://www.gutenberg.org/files/580/580-0.txt&#39;</span><span class="p">:</span>
        <span class="s1">&#39;The Pickwick Papers&#39;</span>
   <span class="p">}</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;Texts&#39;</span><span class="p">):</span> 
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s1">&#39;Texts&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-1-2">
<h2>Exercise 1.2.<a class="headerlink" href="#exercise-1-2" title="Permalink to this headline">¶</a></h2>
<p>Potentially, you can acquire texts using Web Scraping.</p>
<p>The webpage below offers access to the complete work of H.P. Lovecraft.
<a class="reference external" href="http://www.hplovecraft.com/writings/texts/">http://www.hplovecraft.com/writings/texts/</a></p>
<p>Can you write code in Python to download all the texts that are listed on this page?</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "cdsleiden/tdm-tutorial",
            ref: "gh-pages",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../Welcome.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Welcome</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2%20Tokenisation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2. Word frequencies</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Peter Verhaar<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>